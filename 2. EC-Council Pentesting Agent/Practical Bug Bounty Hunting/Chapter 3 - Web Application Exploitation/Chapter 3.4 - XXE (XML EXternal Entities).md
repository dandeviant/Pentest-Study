
---

>[!summary]+ What is XXE?
> XXE is an attack where XML input is provided that contains reference to an **external entity**.
> External entity are such as computer files or documents.
> 
> Example of XXE:
> ```xml
> <?xml version="1.0" encoding="ISO-8859-1"?>
> <!DOCTYPE foo[
> 	<!ELEMENT foo ANY>
> 	<!ENTITY xxe SYSTEM "file:///dev/random" > <!-- file for entity declaration -->
> ]>
> <foo>&xxe;</foo><!-- load the entity defined -->
> ```

### Practical Example with Burp Suite

>[!todo]+ Lab Question
> This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.
> 
> To solve the lab, inject an XML external entity to retrieve the contents of the `/etc/passwd` file. 

> [!tip] Walkthrough
> 1. Visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.
> 2. Insert the following external entity definition in between the XML declaration and the `stockCheck` element: 
>    `<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>`
> 3. Replace the `productId` number with a reference to the external entity: `&xxe;`. The response should contain "Invalid product ID:" followed by the contents of the `/etc/passwd` file.

